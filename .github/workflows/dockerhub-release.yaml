name: Retag RC Docker image

on:
  pull_request_review:
    types: [submitted]

jobs:
  release:
    if: >
      github.event.review.state == 'approved' && (github.event.pull_request.base.ref == 'master' || github.event.pull_request.base.ref == 'main')
    # TODO: Pin reusable workflow to a version tag once v1 is released
    uses: reportportal/.github/.github/workflows/dockerhub-release.yaml@main
    secrets: inherit
    with:
      aws-region: ${{ vars.AWS_REGION }}
      aws-role-arn: ${{ vars.AWS_ROLE_ARN }}
      ecr-repository: service-ui
      target-registry: docker.io
      target-repository: reportportal/service-ui
      platforms: linux/amd64
      release-mode: rc

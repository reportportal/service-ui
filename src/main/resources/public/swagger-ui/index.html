<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <title>Swagger UI</title>
    <link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32"/>
    <link rel="icon" type="image/png" href="images/favicon-16x16.png" sizes="16x16"/>

    <link href='../compiled/scss/swagger.css' media='screen' rel='stylesheet' type='text/css'/>

    <!--<link href='css/typography.css' media='screen' rel='stylesheet' type='text/css'/>-->
    <!--<link href='css/reset.css' media='screen' rel='stylesheet' type='text/css'/>-->
    <!--<link href='css/screen.css' media='screen' rel='stylesheet' type='text/css'/>-->
    <!--<link href='css/reset.css' media='print' rel='stylesheet' type='text/css'/>-->
    <!--<link href='css/print.css' media='print' rel='stylesheet' type='text/css'/>-->

    <script src='lib/object-assign-pollyfill.js' type='text/javascript'></script>
    <script src='lib/jquery-1.8.0.min.js' type='text/javascript'></script>
    <script src='lib/jquery.slideto.min.js' type='text/javascript'></script>
    <script src='lib/jquery.wiggle.min.js' type='text/javascript'></script>
    <script src='lib/jquery.ba-bbq.min.js' type='text/javascript'></script>
    <script src='lib/handlebars-4.0.5.js' type='text/javascript'></script>
    <script src='lib/lodash.min.js' type='text/javascript'></script>
    <script src='lib/backbone-min.js' type='text/javascript'></script>
    <script src='swagger-ui.js' type='text/javascript'></script>
    <script src='lib/marked.js' type='text/javascript'></script>

    <script type="text/javascript">
        $(function () {
            function onErrorAction() {
                window.failRequestCallback && window.failRequestCallback();
            }

            var token = window.localStorage.getItem('session_token');
            var partToken = '';
            var url = window.location.search.match(/url=([^&]+)/);
            if (url && url.length > 1) {
                url = decodeURIComponent(url[1]);
            } else {
                url = "/api/v1/api-docs";
            }
            if (token) {
                partToken = token.split(' ')[1];
                url += '?access_token=' + partToken;
            } else {
                onErrorAction();
            }
//            hljs.configure({
//                highlightSizeThreshold: 5000
//            });


            var swaggerUi = new SwaggerUi({
                url: url,
                dom_id: "swagger-ui-container",
                supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch', 'head', 'options'],
                validatorUrl: null,
                onComplete: function (swaggerApi, swaggerUi) {
                    swaggerApi.clientAuthorizations.add(
                        "Authorization",
                        new SwaggerClient.ApiKeyAuthorization("Authorization", token, "header")
                    );
                    window.successStartCallback && window.successStartCallback();
                    window.changeHeightCallback && window.changeHeightCallback();
                },
                onFailure: function (data) {
                    onErrorAction();
                },
                docExpansion: "none",
                apisSorter: "alpha",
                jsonEditor: false,
                defaultModelRendering: 'schema',
                showRequestHeaders: false,
                showOperationIds: false,
                onRequestComplete: function (errorResponse) {
                    if (errorResponse.status === 401) {
                        onErrorAction();
                    }
                }
            });
            swaggerUi.partToken = partToken;
            swaggerUi.token = token;
            swaggerUi.changeHeight = function () {
                window.changeHeightCallback && window.changeHeightCallback();
            };
            swaggerUi.setInfo = function (info, basePath) {
                window.changeInfoCallback && window.changeInfoCallback(info, basePath);
            };
            swaggerUi.load();
        });
    </script>
</head>

<body class="swagger-section">

<div id="swagger-ui-container" class="swagger-ui-wrap"></div>
</body>
</html>
